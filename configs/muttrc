
# Change the following line to a different editor you prefer.
set editor = "vim +8"

# == Paths
set folder            = ~/.mail/
set alias_file        = ~/.mutt/aliases
set tmpdir            = ~/.mutt/tmpdir
set signature         = ~/.mutt/signature

# == Identity
set realname = "Matthew Lyon"
set from="Matthew Lyon <matthew@lyonheart.us>"
alternates "(sanehatter@gmail.com)|(matt.*@flowerpowered.com)|(matt.*@postsomnia.com)|(matt@invokearts.com)"
set use_from
set sendmail="msmtp -a lyonheart"
set record="+Lyonheart/sent"

# == Basics
set beep              = no          # shut up
set wait_key          = no          # shut up
set mbox_type         = Maildir
set timeout           = 3
set mail_check        = 0
unset move                          # gmail handles this for us
set delete                          # shut up
unset confirmappend                 # shut up
set quit=ask-yes                    # ok maybe don't shut up
unset mark_old                      # don't need mutt's "old" noise
set pipe_decode                     # strip headers and eval mimes when piping
set thorough_search                 # strip headers and eval mimes for searching

# == Status Bar
set status_chars  = " *%A"
set status_format = "%f   %m messages%?n? new: %n?%?u? unread: %u?%?t? tagged: %t?%?p? drafts: %p?%> %s %S"

# == Notmuch
set virtual_spoolfile = yes
set nm_hidden_tags=
set nm_query_type=threads
virtual-mailboxes \
  "inbox"         "notmuch://?query=tag:inbox" \
  "flagged"       "notmuch://?query=tag:flagged and not tag:trash" \
  "unread to me"  "notmuch://?query=tag:unread and (to:sanehatter@gmail.com or to:matthew@lyonheart.us)" \
  "sent"          "notmuch://?query=tag:sent"
source ~/.mutt/mailboxes
virtual-mailboxes \
  "-trash"        "notmuch://?query=tag:trash" \
  "-spam"         "notmuch://?query=tag:spam and not tag:inbox" \
  "1w"            "notmuch://?query=date:1w.. and not tag:spam and not tag:trash" \
  "6w"            "notmuch://?query=date:6w.. and not tag:spam and not tag:trash" \
  "attachments"   "notmuch://?query=tag:attachment"
set vfolder_format = "%-20.20f %5N %5n"
set sort_browser=unsorted

# == Sidebar
set sidebar_visible = no

# == Header Display
ignore *
unignore  From To Cc Date Subject
unhdr_order *
hdr_order date: to: cc: from: subject:

# == Index
set date_format = "%e %b %y %H:%M"
set index_format="%[%e %b %y %R] %Z %?M?%2M&  ? %-10.10g %-30.30F %s"
set sort = threads
set sort_aux = 'last-date-received'
set uncollapse_jump
set sort_re
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set auto_tag
folder-hook . "exec collapse-all"

# == Pager
set pager_index_lines = 10
set pager_context = 5
set pager_stop
set menu_scroll
set tilde
set markers=no                          # disable '+' at beginning of wrapped lines
set smart_wrap=yes
set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
alternative_order text/plain text/enriched text/html
auto_view text/html

# == Compose
set envelope_from                       #
set sig_dashes                          # dashes before sig
set edit_headers                        # show headers when composing
# set autoedit                            # skip straight to compose
set fast_reply                          # skip to compose when replying
unset askcc                             # don't ask for cc:
unset mime_forward                      # inline message in forward
set mime_forward
set mime_forward_rest=yes               # forward attachments from message
set forward_format = "Fwd: %s"          # format of subject when forwarding
set forward_decode                      # decode when forwarding
set attribution = "On %d, %n wrote:"    # quote header
set reply_to                            # reply using 'Reply To:' header
set reverse_name                        # reply using account received
set include                             # include message in replies
set forward_quote                       # include message in forwards
set text_flowed=yes
set sendmail_wait = 0

set query_command = "contacts -Sf '%eTOKEN%n' '%s' | sed -e 's/TOKEN/\t/g'"

# == PGP
set pgp_good_sign = "^gpg: Good signature from"
set pgp_sign_as = 3351BD75
set my_hdr = "X-PGP-Key: http://lyonheart.us/matthew_lyon_gpg.txt"

set pgp_timeout=1800
set pgp_use_gpg_agent
set pgp_verify_sig
set pgp_autosign
set pgp_replysign
set pgp_replyencrypt
set pgp_replysignencrypted
set pgp_decode_command="gpg %?p?--passphrase-fd 0? --no-verbose --batch --output - %f"
set pgp_verify_command="gpg --no-verbose --batch --output - --verify %s %f"
set pgp_decrypt_command="gpg --passphrase-fd 0 --no-verbose --batch --output - %f"
set pgp_sign_command="gpg --no-verbose --batch --output - --passphrase-fd 0 --armor --detach-sign --textmode %?a?-u %a? %f"
set pgp_clearsign_command="gpg --no-verbose --batch --output - --passphrase-fd 0 --armor --textmode --clearsign %?a?-u %a? %f"
set pgp_encrypt_only_command="pgpewrap gpg --batch --quiet --no-verbose --output - --encrypt --textmode --armor --always-trust --encrypt-to 0xC9C40C31 -- -r %r -- %f"
set pgp_encrypt_sign_command="pgpewrap gpg --passphrase-fd 0 --batch --quiet --no-verbose --textmode --output - --encrypt --sign %?a?-u %a? --armor --always-trust --encrypt-to 0xC9C40C31 -- -r %r -- %f"
set pgp_import_command="gpg --no-verbose --import -v %f"
set pgp_export_command="gpg --no-verbose --export --armor %r"
set pgp_verify_key_command="gpg --no-verbose --batch --fingerprint --check-sigs %r"
set pgp_list_pubring_command="gpg --no-verbose --batch --with-colons --list-keys %r" 
set pgp_list_secring_command="gpg --no-verbose --batch --with-colons --list-secret-keys %r" 


# === Editing

# tags
tag-transforms \
  "inbox"           "‚ú§" \
  "unread"          "‚ñ∫" \
  "flagged"         "‚òÖ " \
  "signed"          "‚úî " \
  "replied"         "‚Üª " \
  "sent"            "‚á•" \
  "spam"            "üí©" \
  "trash"           "‚òì" \
  "attachment"      "‚®Æ" \
  "lyonheart"       "¬£" \
  "sanehatter"      "√ü" \
  "old_address"     "‚ù¶"

source $HOME/.mutt/mappings.muttrc
source $HOME/.mutt/colors.muttrc
